# Generation-of-Synthetic-Echocardiograms-Using-Video-Diffusion-Models
<TOC>

**This repository contains the implemented Video Diffusion model. It also contains the modified super-resolution models and the code of the evaluation metrics used.**

To see synthetic samples generated by our model visit https://alexolpe.github.io/final-thesis/index.html


## Environment configuration
Run the following command to install de conda environment:
```shell
   conda env create -f new_environment.yml
```


## Video Diffusion Model
Run the following command to train the model
```shell
python3 video-diffusion/train_video_diffusion.py
```

Run the following command for inference
```shell
python3 video-diffusion/sample_video_diffusion.py
```

## Real-ESRGAN
Run the following command to train the model
```shell
python3 Real-ESRGAN/realesrgan/train.py
```

Run the following command for inference
```shell
python3 Real-ESRGAN/inference_realesrgan_video.py
```

## IDMSCR

Run the following command to train the model. Use ```-p val``` for inference
```shell
python -m torch.distributed.launch --nproc_per_node=1 --master_port=12398 --use_env IDMSCR/sr_newddp.py -p test
```

## SRGAN
Run the following command to train the SRGAN
```shell
python3 SRGAN/train_srgan_x5.py
```

Run the following command for inference
```shell
python3 SRGAN/inference_video.py
```

## Compute FID
Run the following command to convert AVI file to PNG

   ```shell
  python3 FID/video2frame.py --input <input AVI directory> --output <output PNG directory>
   ```
Run the following command to compute the FID between two directories with PNG files

  ```shell
  python3 FID/fid.py <first_directory> <second_directory>
  ```

## Compute FVD
Run the following command to compute the FVD between two directories with AVI files

  ```shell
  python3 FVD/fvd.py --real <first_directory> --fake <second_directory>
  ```